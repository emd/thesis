\chapter{Some identities for the PCI wavenumber response}
\label{app:PCIResponseIdentities}


\section{Phase factor in the beam's near field}
The effect of wavenumber-dependent manipulation $T(k_x)$
on the $m$\ts{th} scattered beam is given by
the phase factor $\mathcal{P}(x, m, k)$ as defined in
(\ref{eq:InterferometricMethods:mth_diffracted_beam_kx_filtered_phase_factor}),
which is repeated here for completeness
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2 \pi}
    \int dx' \,
    \exp\left[ \frac{-x'^2}{w(z)^2} \right]
    \exp\left\{%
      i \left[%
        m k x'
        +
        \frac{k_0 x'^2}{2 R(z)}
      \right]
    \right\}
    \\
    &\qquad \times
    \int dk_x' \,
    T(k_x')
    e^{i k_x' (x_m - x')}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_full}
\end{equation}
The integrals are over the full domain of $x'$ and $k_x'$, but
note that contributions to the integral
from regions outside of $|x'| \lesssim w(z)$
are suppressed by the Gaussian envelope such that
the maximum value of the curvature-induced phase factor obeys
\begin{equation}
  \left[ \frac{k_0 x'^2}{2 R(z)} \right]_{\text{max}}
  \sim
  \frac{k_0 [w(z)]^2}{2 R(z)}
  \label{eq:PCIResponseIdentities:curvature_phase_factor_constraint_general}
\end{equation}
Now, in the beam's near field
($z \ll z_R$, which is often experimentally relevant),
the beam's waist and radius of curvature are
\begin{align}
  w(z) &\approx w_0
  \\
  R(z) &\approx \frac{z_R^2}{z}
\end{align}
as can be easily verified by examining the definitions in
(\ref{eq:InterferometricMethods:Gaussian_beam_width}) and
(\ref{eq:InterferometricMethods:Gaussian_beam_radius_of_curvature}),
respectively.
Thus,
(\ref{eq:PCIResponseIdentities:curvature_phase_factor_constraint_general})
becomes
\begin{align}
  \left[ \frac{k_0 x'^2}{2 R(z)} \right]_{\text{max}}
  &\sim
  \frac{k_0 [w(z)]^2}{2 R(z)}
  \notag \\
  &\approx
  \frac{k_0 w_0^2}{2 (z / z_R)}
  \notag \\
  &= \frac{z}{z_R}
  \notag \\
  &\ll 1
  \label{eq:PCIResponseIdentities:curvature_phase_factor_constraint_near_field}
\end{align}
where $z / z_R \ll 1$ follows from the near-field assumption.
Thus, in the beam's near field,
the curvature-induced phase factor is negligible, and
$\mathcal{P}(x, m, k)$ reduces to
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2 \pi}
    \int dx' \,
    e^{-\left[ x' / w(z) \right]^2}
    e^{i m k x'}
    \\
    &\qquad \times
    \int dk_x' \,
    T(k_x')
    e^{i k_x' (x_m - x')}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field}
\end{equation}
This near-field assumption will be implicit
in the remainder of the discussion about PCI.


\section{The PCI phase factor}
The transfer function of the PCI phase plate can be described as
\begin{equation}
  \begin{aligned}
    T(k_x)
    &=
    i \sqrt{\eta} \, H(k_g - |k_x|)
    \\
    &\quad +
    H(|k_x| - k_g)
    H(k_D - |k_x|)
  \end{aligned}
  \label{eq:PCIResponseIdentities:phase_plate_transfer_function}
\end{equation}
where $H(x)$ is the Heaviside step function defined as
\begin{equation}
  H(x)
  =
  \begin{cases}
    0, \quad &x < 0 \\
    1, \quad &x \geq 0
  \end{cases}
  \label{eq:PCIResponseIdentities:Heaviside_step_function}
\end{equation}
$\eta$ is the reflectivity of the phase-plate groove, and
$k_g$ and $k_D$ are the low-$k$ and high-$k$ cutoffs of the phase plate
as defined in
(\ref{eq:InterferometricMethods:pci_kmin_engineering}) and
(\ref{eq:InterferometricMethods:pci_kmax_engineering}), respectively.
Thus, the PCI phase factor $\mathcal{P}(x, m, k)$ is
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2 \pi}
    \int dx' \,
    e^{-\left[ x' / w(z) \right]^2}
    e^{i m k x'}
    \\
    &\begin{aligned}
      \quad
      \times
      \Biggl\{%
        &\int_{-k_D}^{-k_g} dk_x' \,
        e^{i k_x' (x_m - x')}
        \\
        &+
        i \sqrt{\eta}
        \int_{-k_g}^{k_g} dk_x' \,
        e^{i k_x' (x_m - x')}
        \\
        &+
        \int_{k_g}^{k_D} dk_x' \,
        e^{i k_x' (x_m - x')}
      \Biggr\}
    \end{aligned}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_integrals}
\end{equation}


\section{Some useful integrals for evaluation of $\mathcal{P}(x, m, k)$}


\subsection{Finite-domain inverse Fourier transforms of unity}
Note that
\begin{equation}
  \int_{k_1}^{k_2} dk_x
  e^{i k_x x}
  =
  \frac{e^{i k_2 x} - e^{i k_1 x}}{ix}
\end{equation}
Now, if $k_1 = -k_2$, this simplifies to
\begin{equation}
  \int_{-k_2}^{k_2} dk_x
  e^{i k_x x}
  =
  2 k_2 \sinc \left( \frac{k_2 x}{\pi} \right)
  \label{eq:PCIResponseIdentities:finite_domain_inverse_FT_groove}
\end{equation}
where
\begin{equation}
  \sinc(x) = \frac{\sin(\pi x)}{\pi x}
  \label{eq:PCIResponseIdentities:normalized_sinc}
\end{equation}
is the normalized sinc function;
note that sinc is an \emph{even} function.
Finally, note that
\begin{align}
  \int_{-k_2}^{-k_1}
  &dk_x
  e^{i k_x x}
  +
  \int_{k_1}^{k_2} dk_x
  e^{i k_x x}
  \notag \\
  &=
  \int_{-k_2}^{k_2} dk_x
  e^{i k_x x}
  -
  \int_{-k_1}^{k_1} dk_x
  e^{i k_x x}
  \notag \\
  &=
  2 k_2 \sinc \left( \frac{k_2 x}{\pi} \right)
  -
  2 k_1 \sinc \left( \frac{k_1 x}{\pi} \right)
  \label{eq:PCIResponseIdentities:finite_domain_inverse_FT_face}
\end{align}
Using (\ref{eq:PCIResponseIdentities:finite_domain_inverse_FT_groove}) and
(\ref{eq:PCIResponseIdentities:finite_domain_inverse_FT_face}),
it is easy to see that
(\ref{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_integrals})
becomes
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{\pi}
    \int dx' \,
    e^{-\left[ x' / w(z) \right]^2}
    e^{i m k x'}
    \\
    &\begin{aligned}
      \quad
      \times
      \Biggl\{%
        &k_D \sinc\left[ \frac{k_D}{\pi} (x' - x_m) \right]
        \\
        &-
        k_g \sinc\left[ \frac{k_g}{\pi} (x' - x_m) \right]
        \\
        &+
        i \sqrt{\eta}
        k_g \sinc\left[ \frac{k_g}{\pi} (x' - x_m) \right]
      \Biggr\}
    \end{aligned}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_sincs}
\end{equation}


\subsection{Integral of offset sinc with complex-Gaussian weighting}
Note that
(\ref{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_sincs})
consists of several integrals of the form
\begin{equation}
  I
  \equiv
  \frac{b}{\pi}
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \sinc\left[ \frac{b}{\pi} (x - x_0) \right]
  \label{eq:PCIResponseIdentities:I_x0_abc_definition}
\end{equation}
where $a > 0$ and $x_0$, $b$, and $c$ are real.
While daunting, the integral can be evaluated ``analytically''
in terms of complex error functions as follows
\begin{align}
  I
  &=
  \frac{b}{\pi}
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \sinc\left[ \frac{b}{\pi} (x - x_0) \right]
  \notag \\
  &=
  \frac{1}{\pi}
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \cdot
  \frac{\sin[b (x - x_0)]}{x - x_0}
  \notag \\
  &=
  \frac{1}{\pi}
  \int_{0}^{b} d\beta
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \cos[\beta (x - x_0)]
  \notag \\
  &=
  \frac{1}{2 \pi}
  \int_{0}^{b} d\beta
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \left[%
    e^{i \beta (x - x_0)}
    +
    e^{-i \beta (x - x_0)}
  \right]
  \notag \\
  &\begin{aligned}
    &=
    \frac{1}{2 \pi}
    \int_{0}^{b} d\beta
    \int dx \,
    e^{-a x^2}
    e^{i [(\beta + c) x - \beta x_0]}
    \\
    &\quad+
    \frac{1}{2 \pi}
    \int_{0}^{b} d\beta
    \int dx \,
    e^{-a x^2}
    e^{i [-(\beta - c) x + \beta x_0]}
  \end{aligned}
  \notag \\
  &\begin{aligned}
    &=
    \frac{1}{2 \pi}
    \int_{0}^{b} d\beta
    \int dx \,
    e^{-a x^2}
    e^{i [(\beta + c) x - \beta x_0]}
    \\
    &\quad-
    \frac{1}{2 \pi}
    \int_{0}^{-b} d\beta'
    \int dx \,
    e^{-a x^2}
    e^{i [(\beta' + c) x - \beta' x_0]}
  \end{aligned}
  \notag \\
  &=
  \frac{1}{2 \pi}
  \int_{-b}^{b} d\beta
  \int dx \,
  e^{-a x^2}
  e^{i [(\beta + c) x - \beta x_0]}
  \notag \\
  &=
  \frac{1}{2 \pi}
  \int_{-b}^{b} d\beta \,
  e^{-(\beta + c)^2 / 4 a}
  e^{-i \beta x_0}
  \int dx \,
  e^{-a [x - i (\beta + c) / 2a]^2}
  \notag \\
  &=
  \frac{1}{2 \sqrt{\pi a}}
  \int_{-b}^{b} d\beta \,
  e^{-(\beta + c)^2 / 4 a}
  e^{-i \beta x_0}
  \notag \\
  &=
  \frac{1}{2 \sqrt{\pi a}}
  e^{i c x_0}
  \int_{c - b}^{c + b} d\beta' \,
  e^{-\beta'^2 / 4 a}
  e^{-i \beta' x_0}
  \notag \\
  &=
  \frac{1}{2 \sqrt{\pi a}}
  e^{-a x_0^2}
  e^{i c x_0}
  \int_{c - b}^{c + b} d\beta' \,
  e^{-(\beta' + i 2 a x_0)^2 / 4 a}
  \notag \\
  &=
  \frac{1}{\sqrt{\pi}}
  e^{-a x_0^2}
  e^{i c x_0}
  \int_{u(c, - b)}^{u(c, b)} du \,
  e^{-u^2}
  \notag \\
  &=
  \frac{1}{2}
  e^{-a x_0^2}
  e^{i c x_0}
  \left\{
    \erf[u(c, b)]
    -
    \erf[u(c, - b)]
  \right\}
  \label{eq:PCIResponseIdentities:I_x0_abc_evaluated}
\end{align}
where the error function is defined for complex argument $z$ as
\begin{equation}
  \erf(z)
  =
  \frac{2}{\sqrt{\pi}}
  \int_0^z e^{-t^2} dt
  \label{eq:PCIResponseIdentities:error_function}
\end{equation}
and
\begin{equation}
  u(c, b) = \frac{1}{2 \sqrt{a}} [(c + b) + i 2 a x_0]
\end{equation}

Now, substituting the appropriate values
into (\ref{eq:PCIResponseIdentities:I_x0_abc_evaluated})
\begin{equation}
  x_0 \equiv x_m,
  \qquad
  a \equiv \frac{1}{w(z)^2},
  \qquad
  b \equiv k_j,
  \qquad
  c \equiv mk
  \notag
\end{equation}
yields
\begin{equation}
  I
  =
  \frac{1}{2}
  e^{-[x_m / w(z)]^2}
  e^{i m k x_m}
  \mathcal{D}(m, k_j)
  \label{eq:PCIResponseIdentities:I_x0_abc_evaluated_lab_parameters}
\end{equation}
where the difference function $\mathcal{D}$ is defined as
\begin{equation}
  \mathcal{D}(m, k_j)
  =
  \erf[u(m, k_j)]
  -
  \erf[u(m, -k_j)]
  \label{eq:PCIResponseIdentities:difference_function}
\end{equation}
and
\begin{equation}
  u(m, k_j)
  =
  \frac{w(z)}{2}
  \left[%
    (m k + k_j)
    +
    i \frac{2 x_m}{w(z)^2}
  \right]
  \label{eq:PCIResponseIdentities:u}
\end{equation}


\section{Symmetries in the image plane}
According to the image-plane coordinate transformation in
(\ref{eq:InterferometricMethods:coordinate_transformation_imaging_plane}),
\begin{equation}
  x_m' = x'
\end{equation}
to first order in $k / k_0$; that is,
$x_m'$ is \emph{independent} of $m$ in the image plane.
This leads to several useful symmetries in the image plane.


\subsection{Properties of $u$}
The complex-valued function $u$ is defined in
(\ref{eq:PCIResponseIdentities:u}).
Note that
\begin{align}
  u(-m, -k_j)
  &=
  \frac{w(z)}{2} \left[ (-m k - k_j) + i \frac{2 x_{-m}}{w(z)^2} \right]
  \notag \\
  &=
  \frac{w(z)}{2} \left[ -(m k + k_j)+ i \frac{2 x_{m}}{w(z)^2} \right]
  \notag \\
  &=
  \frac{-w(z)}{2} \left[ (m k + k_j) - i \frac{2 x_{m}}{w(z)^2} \right]
  \notag \\
  &=
  \frac{-w(z)}{2} \left[ (m k + k_j) + i \frac{2 x_{m}}{w(z)^2} \right]^*
  \notag \\
  &=
  -[u(m, k_j)]^{*}
\end{align}
where $z^*$ indicates the complex conjugate of $z$.


\subsection{Properties of the error function}
The error function has two useful properties
that will be exploited shortly.
First, the error function is \emph{odd}
\begin{equation}
  \erf(-z) = - \erf(z)
  \label{eq:PCIResponseIdentities:error_function_is_odd}
\end{equation}
as is easily determined by inspection.
Second, the error function \emph{commutes} with complex conjugation
\begin{equation}
  \erf(z^*) = [\erf(z)]^*
  \label{eq:PCIResponseIdentities:error_function_commutativity}
\end{equation}
where $z^*$ is the complex conjugate of $z$.


\subsection{Properties of $\mathcal{D}$}
The complex-valued difference function $\mathcal{D}$ is defined in
(\ref{eq:PCIResponseIdentities:difference_function}).
Note that
\begin{align}
  \mathcal{D}(-m, k_j)
  &=
  \erf[u(-m, k_j)] - \erf[u(-m, -k_j)]
  \notag \\
  &=
  \erf\{-[u(m, -k_j)]^*\} - \erf\{-u(m, k_j)]^*\}
  \notag \\
  &=
  -\{\erf[u(m, -k_j)]\}^* + \{\erf[u(m, k_j)]\}^*
  \notag \\
  &=
  \{\erf[u(m, k_j)] - \erf[u(m, -k_j)]\}^*
  \notag \\
  &=
  [\mathcal{D}(m, k_j)]^*
\end{align}


\section{Finite-domain inverse Fourier transform of a shifted Gaussian}
Each of the integrals in
%(\ref{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_integrals})
can be easily evaluated by completing the square
of the exponential arguments to yield
\begin{equation}
  \begin{aligned}
    \int_{k_1}^{k_2}
    dk'
    e^{i k' x}
    e^{-\left[ \frac{w_0}{2} \left( k' - m k \right) \right]^2}
    =
    \frac{\sqrt{\pi}}{w_0}
    &e^{-(x / w_0)^2}
    e^{i m k x}
    \\
    &\times \delta(k_1, k_2, m)
  \end{aligned}
  \label{eq:PCIResponseIdentities:inverse_fourier_transform_shifted_Gaussian}
\end{equation}
where
\begin{equation}
  \delta(k_1, k_2, m)
  \equiv
  \erf[u(k_2, m)] - \erf[u(k_1, m)]
  \label{eq:PCIResponseIdentities:difference_of_error_functions}
\end{equation}
and
\begin{equation}
  u(k_j, m) \equiv \frac{w_0}{2}(k_j - m k) + i \frac{x}{w_0}
  %\label{eq:PCIResponseIdentities:u}
\end{equation}


\section{Some useful symmetries and degeneracies}


\subsection{The error function}
By applying (\ref{eq:PCIResponseIdentities:error_function_is_odd}) and
(\ref{eq:PCIResponseIdentities:error_function_commutativity}),
it naturally follows that
\begin{equation}
  erf[u(-k_j, -m)] = - \, \{ erf[u(k_j, m)] \}^*
  \label{eq:PCIResponseIdentities:error_function_symmetry}
\end{equation}


\subsection{The difference between error functions}
By applying the error function's symmetry in
(\ref{eq:PCIResponseIdentities:error_function_symmetry}),
it naturally follows that
the difference between two error functions satisfies
\begin{equation}
  \delta(-k_1, -k_2, -m)
  =
  [\delta(k_2, k_1, m)]^*
  \label{eq:PCIResponseIdentities:difference_of_error_functions_symmetry}
\end{equation}


\subsection{The phase-plate operator $\mathcal{P}$}
Eq.~(\ref{eq:PCIResponseIdentities:inverse_fourier_transform_shifted_Gaussian})
allows (\ref{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_integrals})
to be rewritten as
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, k, m)
    &=
    C_m
    [%
      \delta(-k_D, -k_g, m)
      +
      \delta(k_g, k_D, m)
    ]
    \\
    &\quad+
    i \sqrt{\eta} C_m \delta(-k_g, k_g, m)
  \end{aligned}
  \label{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_simplified}
\end{equation}
where
\begin{equation}
  C_m
  =
  \frac{1}{2} \left[ e^{-(x / w_0)^2} e^{i m k x} \right]
\end{equation}
Note that $C_m$ is \emph{Hermitian};
that is, $C_{-m} = C_m^*$.
In fact,
(\ref{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_simplified})
can be decomposed into Hermitian $\mathcal{P}_H$ and
anti-Hermitian $\mathcal{P}_A$ components
\begin{equation}
  \mathcal{P}(x, k, m)
  =
  \mathcal{P}_H(x, k, m)
  +
  \mathcal{P}_A(x, k, m)
  \label{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_Hermitian_decomposed}
\end{equation}
where
\begin{align}
  \mathcal{P}_H(x, k, m)
  &\equiv
  C_m
  [%
    \delta(-k_D, -k_g, m)
    +
    \delta(k_g, k_D, m)
  ]
  \label{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_Hermitian}
  \\
  \mathcal{P}_A(x, k, m)
  &\equiv
  i \sqrt{\eta} C_m \delta(-k_g, k_g, m)
  \label{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_antiHermitian}
\end{align}
Application of
(\ref{eq:PCIResponseIdentities:difference_of_error_functions_symmetry})
readily shows that
\begin{align}
  \mathcal{P}_H(x, k, -m) &= [\mathcal{P}_H(x, k, m)]^*
  \\
  \mathcal{P}_A(x, k, -m) &= -[\mathcal{P}_A(x, k, m)]^*
\end{align}
Thus,
\begin{equation}
  \mathcal{P}(x, k, -m)
  =
  [\mathcal{P}_H(x, k, m)]^*
  -
  [\mathcal{P}_A(x, k, m)]^*
  \label{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_symmetry}
\end{equation}

Note that the above symmetry also implies a degeneracy when $m = 0$.
Specifically,
(\ref{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_Hermitian_decomposed})
states that
\begin{equation}
  \mathcal{P}(x, k, +0)
  =
  \mathcal{P}_H(x, k, 0)
  +
  \mathcal{P}_A(x, k, 0)
  \label{eq:PCIResponseIdentities:phase_plate_action_on_plus0_beam}
\end{equation}
while (\ref{eq:PCIResponseIdentities:phase_plate_action_on_mth_beam_symmetry})
shows that
\begin{equation}
  \mathcal{P}(x, k, -0)
  =
  [\mathcal{P}_H(x, k, 0)]^*
  -
  [\mathcal{P}_A(x, k, 0)]^*
  \label{eq:PCIResponseIdentities:phase_plate_action_on_minus0_beam}
\end{equation}
Of course, $\mathcal{P}(x, k, +0) = \mathcal{P}(x, k, -0)$; that is
\begin{equation}
  \mathcal{P}_H(x, k, 0)
  +
  \mathcal{P}_A(x, k, 0)
  =
  [\mathcal{P}_H(x, k, 0)]^*
  -
  [\mathcal{P}_A(x, k, 0)]^*
\end{equation}
Further, as $\mathcal{P}_H$ is dependent on $k_D$ but $\mathcal{P}_A$ is not,
$\mathcal{P}_H$ and $\mathcal{P}_A$ must be linearly independent;
that is
\begin{align}
  \mathcal{P}_H(x, k, 0) &= [\mathcal{P}_H(x, k, 0)]^*
  \\
  \mathcal{P}_A(x, k, 0) &= -[\mathcal{P}_A(x, k, 0)]^*
\end{align}
This proves that $\mathcal{P}_H(x, k, 0)$ is purely \emph{real} and
that $\mathcal{P}_A(x, k, 0)$ is purely \emph{imaginary}.

Another useful degeneracy occurs
when the fluctuation wavenumber vanishes (i.e.\ $k = 0$).
Note that $\mathcal{P}(x, k, m) = \mathcal{P}(x, m \cdot k)$;
that is, the $m$ and $k$ dependence of $\mathcal{P}$
only appears as the \emph{product} $(m \cdot k)$.
Just as $m = 0$ at finite $k$ yields $(m \cdot k) = 0$,
$k = 0$ at finite $m$ also gives $(m \cdot k) = 0$;
thus,
\begin{equation}
  \mathcal{P}(x, k=0, m) = \mathcal{P}(x, k, m=0)
  \label{eq:PCIResponseIdentities:phase_plate_action_on_wavenumber_0}
\end{equation}
Eq.~(\ref{eq:PCIResponseIdentities:phase_plate_action_on_wavenumber_0})
will be helpful in showing that the PCI response vanishes at $k = 0$.
