\chapter{Some identities for the PCI wavenumber response}
\label{app:PCIResponseIdentities}


\section{Phase factor in the beam's near field}
The effect of wavenumber-dependent manipulation $T(k_x)$
on the $m$\ts{th} scattered beam is given by
the phase factor $\mathcal{P}(x, m, k)$ as defined in
(\ref{eq:InterferometricMethods:mth_diffracted_beam_kx_filtered_phase_factor}),
which is repeated here for completeness
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2 \pi}
    \int dx' \,
    \exp\left[ \frac{-x'^2}{w(z)^2} \right]
    \exp\left\{%
      i \left[%
        m k x'
        +
        \frac{k_0 x'^2}{2 R(z)}
      \right]
    \right\}
    \\
    &\qquad \times
    \int dk_x' \,
    T(k_x')
    e^{i k_x' (x_m - x')}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_full}
\end{equation}
The integrals are over the full domain of $x'$ and $k_x'$, but
note that contributions to the integral
from regions outside of $|x'| \lesssim w(z)$
are suppressed by the Gaussian envelope such that
the maximum value of the curvature-induced phase factor obeys
\begin{equation}
  \left[ \frac{k_0 x'^2}{2 R(z)} \right]_{\text{max}}
  \sim
  \frac{k_0 [w(z)]^2}{2 R(z)}
  \label{eq:PCIResponseIdentities:curvature_phase_factor_constraint_general}
\end{equation}
Now, in the beam's near field
($z \ll z_R$, which is often experimentally relevant),
the beam's waist and radius of curvature are
\begin{align}
  w(z) &\approx w_0
  \\
  R(z) &\approx \frac{z_R^2}{z}
\end{align}
as can be easily verified by examining the definitions in
(\ref{eq:InterferometricMethods:Gaussian_beam_width}) and
(\ref{eq:InterferometricMethods:Gaussian_beam_radius_of_curvature}),
respectively.
Thus,
(\ref{eq:PCIResponseIdentities:curvature_phase_factor_constraint_general})
becomes
\begin{align}
  \left[ \frac{k_0 x'^2}{2 R(z)} \right]_{\text{max}}
  &\sim
  \frac{k_0 [w(z)]^2}{2 R(z)}
  \notag \\
  &\approx
  \frac{k_0 w_0^2}{2 (z / z_R)}
  \notag \\
  &= \frac{z}{z_R}
  \notag \\
  &\ll 1
  \label{eq:PCIResponseIdentities:curvature_phase_factor_constraint_near_field}
\end{align}
where $z / z_R \ll 1$ follows from the near-field assumption.
Thus, in the beam's near field,
the curvature-induced phase factor is negligible, and
$\mathcal{P}(x, m, k)$ reduces to
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2 \pi}
    \int dx' \,
    e^{-\left[ x' / w(z) \right]^2}
    e^{i m k x'}
    \\
    &\qquad \times
    \int dk_x' \,
    T(k_x')
    e^{i k_x' (x_m - x')}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field}
\end{equation}
This near-field assumption will be implicit
in the remainder of the discussion about PCI.


\section{The PCI phase factor}
The transfer function of the PCI phase plate can be described as
\begin{equation}
  \begin{aligned}
    T(k_x)
    &=
    i \sqrt{\eta} \, H(k_g - |k_x|)
    \\
    &\quad +
    H(|k_x| - k_g)
    H(k_D - |k_x|)
  \end{aligned}
  \label{eq:PCIResponseIdentities:phase_plate_transfer_function}
\end{equation}
where $H(x)$ is the Heaviside step function defined as
\begin{equation}
  H(x)
  =
  \begin{cases}
    0, \quad &x < 0 \\
    1, \quad &x \geq 0
  \end{cases}
  \label{eq:PCIResponseIdentities:Heaviside_step_function}
\end{equation}
$\eta$ is the reflectivity of the phase-plate groove, and
$k_g$ and $k_D$ are the low-$k$ and high-$k$ cutoffs of the phase plate
as defined in
(\ref{eq:InterferometricMethods:pci_kmin_engineering}) and
(\ref{eq:InterferometricMethods:pci_kmax_engineering}), respectively.
Thus, the PCI phase factor $\mathcal{P}(x, m, k)$ is
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2 \pi}
    \int dx' \,
    e^{-\left[ x' / w(z) \right]^2}
    e^{i m k x'}
    \\
    &\begin{aligned}
      \quad
      \times
      \Biggl\{%
        &\int_{-k_D}^{-k_g} dk_x' \,
        e^{i k_x' (x_m - x')}
        \\
        &+
        i \sqrt{\eta}
        \int_{-k_g}^{k_g} dk_x' \,
        e^{i k_x' (x_m - x')}
        \\
        &+
        \int_{k_g}^{k_D} dk_x' \,
        e^{i k_x' (x_m - x')}
      \Biggr\}
    \end{aligned}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_integrals}
\end{equation}


\section{Some useful integrals for evaluation of $\mathcal{P}(x, m, k)$}


\subsection{Finite-domain inverse Fourier transforms of unity}
Note that
\begin{equation}
  \int_{k_1}^{k_2} dk_x
  e^{i k_x x}
  =
  \frac{e^{i k_2 x} - e^{i k_1 x}}{ix}
\end{equation}
Now, if $k_1 = -k_2$, this simplifies to
\begin{equation}
  \int_{-k_2}^{k_2} dk_x
  e^{i k_x x}
  =
  2 k_2 \sinc \left( \frac{k_2 x}{\pi} \right)
  \label{eq:PCIResponseIdentities:finite_domain_inverse_FT_groove}
\end{equation}
where
\begin{equation}
  \sinc(x) = \frac{\sin(\pi x)}{\pi x}
  \label{eq:PCIResponseIdentities:normalized_sinc}
\end{equation}
is the normalized sinc function;
note that sinc is an \emph{even} function.
Finally, note that
\begin{align}
  \int_{-k_2}^{-k_1}
  &dk_x
  e^{i k_x x}
  +
  \int_{k_1}^{k_2} dk_x
  e^{i k_x x}
  \notag \\
  &=
  \int_{-k_2}^{k_2} dk_x
  e^{i k_x x}
  -
  \int_{-k_1}^{k_1} dk_x
  e^{i k_x x}
  \notag \\
  &=
  2 k_2 \sinc \left( \frac{k_2 x}{\pi} \right)
  -
  2 k_1 \sinc \left( \frac{k_1 x}{\pi} \right)
  \label{eq:PCIResponseIdentities:finite_domain_inverse_FT_face}
\end{align}
Using (\ref{eq:PCIResponseIdentities:finite_domain_inverse_FT_groove}) and
(\ref{eq:PCIResponseIdentities:finite_domain_inverse_FT_face}),
it is easy to see that
(\ref{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_integrals})
becomes
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{\pi}
    \int dx' \,
    e^{-\left[ x' / w(z) \right]^2}
    e^{i m k x'}
    \\
    &\begin{aligned}
      \quad
      \times
      \Biggl\{%
        &k_D \sinc\left[ \frac{k_D}{\pi} (x' - x_m) \right]
        \\
        &-
        k_g \sinc\left[ \frac{k_g}{\pi} (x' - x_m) \right]
        \\
        &+
        i \sqrt{\eta}
        k_g \sinc\left[ \frac{k_g}{\pi} (x' - x_m) \right]
      \Biggr\}
    \end{aligned}
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_sincs}
\end{equation}


\subsection{Integral of offset sinc with complex-Gaussian weighting}
Note that
(\ref{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_sincs})
consists of several integrals of the form
\begin{equation}
  I
  \equiv
  \frac{b}{\pi}
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \sinc\left[ \frac{b}{\pi} (x - x_0) \right]
  \label{eq:PCIResponseIdentities:I_x0_abc_definition}
\end{equation}
where $a > 0$ and $x_0$, $b$, and $c$ are real.
While daunting, the integral can be evaluated ``analytically''
in terms of complex error functions as follows
\begin{align}
  I
  &=
  \frac{b}{\pi}
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \sinc\left[ \frac{b}{\pi} (x - x_0) \right]
  \notag \\
  &=
  \frac{1}{\pi}
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \cdot
  \frac{\sin[b (x - x_0)]}{x - x_0}
  \notag \\
  &=
  \frac{1}{\pi}
  \int_{0}^{b} d\beta
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \cos[\beta (x - x_0)]
  \notag \\
  &=
  \frac{1}{2 \pi}
  \int_{0}^{b} d\beta
  \int dx \,
  e^{-a x^2}
  e^{i c x}
  \left[%
    e^{i \beta (x - x_0)}
    +
    e^{-i \beta (x - x_0)}
  \right]
  \notag \\
  &\begin{aligned}
    &=
    \frac{1}{2 \pi}
    \int_{0}^{b} d\beta
    \int dx \,
    e^{-a x^2}
    e^{i [(\beta + c) x - \beta x_0]}
    \\
    &\quad+
    \frac{1}{2 \pi}
    \int_{0}^{b} d\beta
    \int dx \,
    e^{-a x^2}
    e^{i [-(\beta - c) x + \beta x_0]}
  \end{aligned}
  \notag \\
  &\begin{aligned}
    &=
    \frac{1}{2 \pi}
    \int_{0}^{b} d\beta
    \int dx \,
    e^{-a x^2}
    e^{i [(\beta + c) x - \beta x_0]}
    \\
    &\quad-
    \frac{1}{2 \pi}
    \int_{0}^{-b} d\beta'
    \int dx \,
    e^{-a x^2}
    e^{i [(\beta' + c) x - \beta' x_0]}
  \end{aligned}
  \notag \\
  &=
  \frac{1}{2 \pi}
  \int_{-b}^{b} d\beta
  \int dx \,
  e^{-a x^2}
  e^{i [(\beta + c) x - \beta x_0]}
  \notag \\
  &=
  \frac{1}{2 \pi}
  \int_{-b}^{b} d\beta \,
  e^{-(\beta + c)^2 / 4 a}
  e^{-i \beta x_0}
  \int dx \,
  e^{-a [x - i (\beta + c) / 2a]^2}
  \notag \\
  &=
  \frac{1}{2 \sqrt{\pi a}}
  \int_{-b}^{b} d\beta \,
  e^{-(\beta + c)^2 / 4 a}
  e^{-i \beta x_0}
  \notag \\
  &=
  \frac{1}{2 \sqrt{\pi a}}
  e^{i c x_0}
  \int_{c - b}^{c + b} d\beta' \,
  e^{-\beta'^2 / 4 a}
  e^{-i \beta' x_0}
  \notag \\
  &=
  \frac{1}{2 \sqrt{\pi a}}
  e^{-a x_0^2}
  e^{i c x_0}
  \int_{c - b}^{c + b} d\beta' \,
  e^{-(\beta' + i 2 a x_0)^2 / 4 a}
  \notag \\
  &=
  \frac{1}{\sqrt{\pi}}
  e^{-a x_0^2}
  e^{i c x_0}
  \int_{u(c, - b)}^{u(c, b)} du \,
  e^{-u^2}
  \notag \\
  &=
  \frac{1}{2}
  e^{-a x_0^2}
  e^{i c x_0}
  \left\{
    \erf[u(c, b)]
    -
    \erf[u(c, - b)]
  \right\}
  \label{eq:PCIResponseIdentities:I_x0_abc_evaluated}
\end{align}
where the error function is defined for complex argument $z$ as
\begin{equation}
  \erf(z)
  =
  \frac{2}{\sqrt{\pi}}
  \int_0^z e^{-t^2} dt
  \label{eq:PCIResponseIdentities:error_function}
\end{equation}
and
\begin{equation}
  u(c, b) = \frac{1}{2 \sqrt{a}} [(c + b) + i 2 a x_0]
\end{equation}

Now, substituting the appropriate values
into (\ref{eq:PCIResponseIdentities:I_x0_abc_evaluated})
\begin{equation}
  x_0 \equiv x_m,
  \qquad
  a \equiv \frac{1}{w(z)^2},
  \qquad
  b \equiv k_j,
  \qquad
  c \equiv mk
  \notag
\end{equation}
yields
\begin{equation}
  I
  =
  \frac{1}{2}
  e^{-[x_m / w(z)]^2}
  e^{i m k x_m}
  \mathcal{D}(m, k_j)
  \label{eq:PCIResponseIdentities:I_x0_abc_evaluated_lab_parameters}
\end{equation}
where the difference function $\mathcal{D}$ is defined as
\begin{equation}
  \mathcal{D}(m, k_j)
  =
  \erf[u(m, k_j)]
  -
  \erf[u(m, -k_j)]
  \label{eq:PCIResponseIdentities:difference_function}
\end{equation}
and
\begin{equation}
  u(m, k_j)
  =
  \frac{w(z)}{2}
  \left[%
    (m k + k_j)
    +
    i \frac{2 x_m}{w(z)^2}
  \right]
  \label{eq:PCIResponseIdentities:u}
\end{equation}
With these definitions
the PCI phase factor from
(\ref{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_sincs})
readily reduces to
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2}
    e^{-[x_m / w(z)]^2}
    e^{i m k x_m}
    \\
    &\quad\times
    \left[%
       \mathcal{D}(m, k_D)
       +
       (i \sqrt{\eta} - 1)
       \mathcal{D}(m, k_g)
    \right]
  \end{aligned}
  \label{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_difference_functions}
\end{equation}


\section{Symmetries and degeneracies in the image plane}
According to the image-plane coordinate transformation in
(\ref{eq:InterferometricMethods:coordinate_transformation_imaging_plane}),
\begin{equation}
  x_m' = x'
\end{equation}
to first order in $k / k_0$; that is,
$x_m'$ is \emph{independent} of $m$ in the image plane.
This leads to several useful symmetries in the image plane.


\subsection{Properties of $u$}
The complex-valued function $u$ is defined in
(\ref{eq:PCIResponseIdentities:u}).
Note that $u$ is anti-Hermitian
\begin{align}
  u(-m, -k_j)
  &=
  \frac{w(z)}{2} \left[ (-m k - k_j) + i \frac{2 x_{-m}}{w(z)^2} \right]
  \notag \\
  &=
  \frac{w(z)}{2} \left[ -(m k + k_j)+ i \frac{2 x_{m}}{w(z)^2} \right]
  \notag \\
  &=
  \frac{-w(z)}{2} \left[ (m k + k_j) - i \frac{2 x_{m}}{w(z)^2} \right]
  \notag \\
  &=
  \frac{-w(z)}{2} \left[ (m k + k_j) + i \frac{2 x_{m}}{w(z)^2} \right]^*
  \notag \\
  &=
  -[u(m, k_j)]^{*}
\end{align}
where $z^*$ indicates the complex conjugate of $z$.


\subsection{Properties of the error function}
The error function has two useful properties
that will be exploited shortly.
First, the error function is \emph{odd}
\begin{equation}
  \erf(-z) = - \erf(z)
  \label{eq:PCIResponseIdentities:error_function_is_odd}
\end{equation}
as is easily determined by inspection.
Second, the error function \emph{commutes} with complex conjugation
\begin{equation}
  \erf(z^*) = [\erf(z)]^*
  \label{eq:PCIResponseIdentities:error_function_commutativity}
\end{equation}
where $z^*$ is the complex conjugate of $z$.


\subsection{Properties of $\mathcal{D}$}
The complex-valued difference function $\mathcal{D}$ is defined in
(\ref{eq:PCIResponseIdentities:difference_function}).
Note that $\mathcal{D}$ is Hermitian with respect to $m$
\begin{align}
  \mathcal{D}(-m, k_j)
  &=
  \erf[u(-m, k_j)] - \erf[u(-m, -k_j)]
  \notag \\
  &=
  \erf\{-[u(m, -k_j)]^*\} - \erf\{-[u(m, k_j)]^*\}
  \notag \\
  &=
  -\{\erf[u(m, -k_j)]\}^* + \{\erf[u(m, k_j)]\}^*
  \notag \\
  &=
  \{\erf[u(m, k_j)] - \erf[u(m, -k_j)]\}^*
  \notag \\
  &=
  \mathcal{D}^*(m, k_j)
  \label{eq:PCIResponseIdentities:difference_function_symmetry}
\end{align}
The above symmetry relation also implies a degeneracy when $m = 0$;
namely, $\mathcal{D}(0, k_j) = \mathcal{D}^*(0, k_j)$, which
proves that $\mathcal{D}(0, k_j)$ is purely \emph{real}.


\subsection{Properties of $\mathcal{P}$}
Using (\ref{eq:PCIResponseIdentities:difference_function_symmetry})
the PCI phase factor from
(\ref{eq:PCIResponseIdentities:mth_diffracted_beam_kx_filtered_phase_factor_near_field_difference_functions})
can be readily written as
\begin{equation}
  \begin{aligned}
    \mathcal{P}(x, m, k)
    &=
    \frac{1}{2}
    e^{-[x_m / w(z)]^2}
    e^{i m k x_m}
    \\
    &\quad\times
    \left[%
      F(x, m, k)
      +
      G(x, m, k)
    \right]
  \end{aligned}
  \label{eq:PCIResponseIdentities:phase_factor_Hermitian_decomposed}
\end{equation}
where
\begin{align}
  F(x, m, k)
  &=
  \mathcal{D}(m, k_D) - \mathcal{D}(m, k_g)
  \\
  G(x, m, k)
  &=
  i \sqrt{\eta} \, \mathcal{D}(m, k_g)
\end{align}
Here, the notation is mnemonic:
the non-grooved portion of the phase plate (i.e.\ the ``face'')
acts on the $m$\ts{th} scattered beam via $F$, while
the phase-plate groove acts on the $m$\ts{th} scattered beam via $G$.
Note that $F$ is Hermitian
\begin{equation}
  F(x, -m, k) = F^*(x, m, k)
  \label{eq:PCIResponseIdentities:mth_beam_interaction_with_face_hermitian}
\end{equation}
while $G$ is anti-Hermitian
\begin{equation}
  G(x, -m, k) = -G^*(x, m, k)
  \label{eq:PCIResponseIdentities:mth_beam_interaction_with_groove_antihermitian}
\end{equation}

Note that the above symmetries also imply a degeneracy when $m = 0$.
Specifically,
(\ref{eq:PCIResponseIdentities:mth_beam_interaction_with_face_hermitian})
states that $F(x, 0, k) = F^*(x, 0, k)$; that is,
$F(x, 0, k)$ is purely \emph{real}
\begin{equation}
  F(x, 0, k) = \real[F(x, 0, k)]
\end{equation}
Similarly,
(\ref{eq:PCIResponseIdentities:mth_beam_interaction_with_groove_antihermitian})
states that $G(x, 0, k) = -G^*(x, 0, k)$; that is,
$G(x, 0, k)$ is purely \emph{imaginary}
\begin{equation}
  G(x, 0, k) = i \cdot \imag[G(x, 0, k)]
\end{equation}

Another useful degeneracy occurs
when the fluctuation wavenumber vanishes (i.e.\ $k = 0$).
Note that $\mathcal{P}(x, k, m) = \mathcal{P}(x, m \cdot k)$;
that is, the $m$ and $k$ dependence of $\mathcal{P}$
only appears as the \emph{product} $(m \cdot k)$.
Just as $m = 0$ at finite $k$ yields $(m \cdot k) = 0$,
$k = 0$ at finite $m$ also gives $(m \cdot k) = 0$;
thus,
\begin{equation}
  \mathcal{P}(x, m, k=0) = \mathcal{P}(x, m=0, k)
  \label{eq:PCIResponseIdentities:phase_factor_for_wavenumber_0}
\end{equation}
Eq.~(\ref{eq:PCIResponseIdentities:phase_factor_for_wavenumber_0})
will be helpful in showing that the PCI response vanishes at $k = 0$.
